<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>CineMaster ‚Ä¢ ∆Øu ƒë√£i khuy·∫øn m√£i</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@500;700;900&display=swap" rel="stylesheet">


    <style>
        :root{
            --ink:#06101f;
            --bg:#0b162c;
            --border:#1b2b4a;
            --blue:#0aa3ff;
            --cyan:#22c1ff;
            --red:#e50914;
        }


        html,body{
            margin:0;
            font-family:'Roboto',sans-serif;
            color:#fff;
            min-height:100vh;
            background-color:var(--ink);
            background-image:
                    radial-gradient(1200px 600px at -10% -35%, rgba(229,9,20,.18), transparent 60%),
                    radial-gradient(900px 400px at 120% -20%, rgba(34,193,255,.12), transparent 60%),
                    linear-gradient(180deg, var(--ink), var(--bg));
            background-repeat:no-repeat,no-repeat,no-repeat;
            background-size:1200px 600px,900px 400px,100% 100%;
            background-position:-10% -35%,120% -20%,0 0;
            background-attachment:fixed,fixed,fixed;
            overflow-x:hidden;
        }


        /* === Tickets background === */
        .tickets-wall{position:fixed;inset:0;pointer-events:none;z-index:0;}
        .tickets-wall .tickets-layer{
            position:absolute;inset:-10%;background-repeat:repeat;background-size:320px 160px;
            opacity:.14;filter:drop-shadow(0 0 20px rgba(22,40,76,.18));transform-origin:center center;
        }
        .tickets-wall .l1{
            transform:rotate(-3deg) scale(1.04);
            background-image:url("data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='320' height='160' viewBox='0 0 320 160'%3E%3Crect fill='none' width='320' height='160'/%3E%3Cg opacity='0.95'%3E%3Cg transform='translate(8,8)'%3E%3Cpath d='M0 24 a12 12 0 0 1 12 -12 h200 a10 10 0 0 0 10 -10 a12 12 0 0 1 12 12 v60 a12 12 0 0 1 -12 12 a10 10 0 0 0 -10 10 H12 a12 12 0 0 1 -12 -12z' fill='%23192A43' stroke='%232c3e66' stroke-width='2'/%3E%3Cline x1='140' y1='12' x2='140' y2='96' stroke='%238fb4ff' stroke-opacity='0.18' stroke-dasharray='6 6'/%3E%3Ccircle cx='60' cy='54' r='22' fill='none' stroke='%238fb4ff' stroke-opacity='0.35' stroke-width='3'/%3E%3Ccircle cx='60' cy='54' r='5' fill='%238fb4ff' opacity='0.3'/%3E%3Cg fill='%238fb4ff' opacity='0.35'%3E%3Ccircle cx='49' cy='44' r='5'/%3E%3Ccircle cx='71' cy='44' r='5'/%3E%3Ccircle cx='49' cy='64' r='5'/%3E%3Ccircle cx='71' cy='64' r='5'/%3E%3C/g%3E%3Cg transform='translate(164,32)' stroke='%23cfe3ff' stroke-opacity='0.38'%3E%3Crect x='0' y='0' width='60' height='24' fill='none'/%3E%3Cpath d='M3 0 v24 M8 0 v24 M11 0 v24 M16 0 v24 M22 0 v24 M27 0 v24 M33 0 v24 M38 0 v24 M45 0 v24 M51 0 v24 M56 0 v24' stroke-width='2'/%3E%3C/g%3E%3Cg transform='translate(164,66)' stroke='%23cfe3ff' stroke-opacity='0.45'%3E%3Cline x1='0' y1='0' x2='76' y2='0' stroke-width='2'/%3E%3Cline x1='0' y1='10' x2='62' y2='10' stroke-width='2'/%3E%3Cline x1='0' y1='20' x2='70' y2='20' stroke-width='2'/%3E%3C/g%3E%3C/g%3E%3Cg transform='translate(8,88)'%3E%3Cpath d='M0 24 a12 12 0 0 1 12 -12 h200 a10 10 0 0 0 10 -10 a12 12 0 0 1 12 12 v60 a12 12 0 0 1 -12 12 a10 10 0 0 0 -10 10 H12 a12 12 0 0 1 -12 -12z' fill='%231b2f50' stroke='%23314774' stroke-width='2'/%3E%3Cline x1='140' y1='12' x2='140' y2='96' stroke='%238fb4ff' stroke-opacity='0.18' stroke-dasharray='6 6'/%3E%3Ccircle cx='60' cy='54' r='22' fill='none' stroke='%23a8c8ff' stroke-opacity='0.32' stroke-width='3'/%3E%3Ccircle cx='60' cy='54' r='5' fill='%23a8c8ff' opacity='0.28'/%3E%3Cg fill='%23a8c8ff' opacity='0.32'%3E%3Ccircle cx='49' cy='44' r='5'/%3E%3Ccircle cx='71' cy='44' r='5'/%3E%3Ccircle cx='49' cy='64' r='5'/%3E%3Ccircle cx='71' cy='64' r='5'/%3E%3C/g%3E%3Cg transform='translate(164,32)' stroke='%23d8e6ff' stroke-opacity='0.38'%3E%3Cpath d='M3 0 v24 M8 0 v24 M11 0 v24 M16 0 v24 M22 0 v24 M27 0 v24 M33 0 v24 M38 0 v24 M45 0 v24 M51 0 v24 M56 0 v24' stroke-width='2'/%3E%3C/g%3E%3Cg transform='translate(164,66)' stroke='%23d8e6ff' stroke-opacity='0.45'%3E%3Cline x1='0' y1='0' x2='76' y2='0' stroke-width='2'/%3E%3Cline x1='0' y1='10' x2='62' y2='10' stroke-width='2'/%3E%3Cline x1='0' y1='20' x2='70' y2='20' stroke-width='2'/%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }
        .tickets-wall .l2{transform:rotate(3deg) scale(1.06);background-position:160px 80px;opacity:.10;background-image:inherit;}


        .grain{
            pointer-events:none;position:fixed;inset:0;opacity:.14;mix-blend-mode:screen;
            background-image:
                    radial-gradient(circle at 20% 30%, rgba(255,255,255,.06) 0 2px, transparent 2px),
                    radial-gradient(circle at 70% 60%, rgba(255,255,255,.05) 0 2px, transparent 2px);
            background-size:200px 200px,260px 260px;animation:drift 18s linear infinite alternate;z-index:1;
        }
        @keyframes drift{from{transform:translate3d(0,0,0)}to{transform:translate3d(30px,-25px,0)}}


        h1{
            color:#fff;
            font-weight:900;
            font-size:1.8rem;
            margin-top:120px;
            text-align:center;
            position:relative;
            z-index:5;
            text-shadow:0 0 15px rgba(34,193,255,.3);
        }


        .discount-list{
            display:grid;
            grid-template-columns:repeat(auto-fit,minmax(420px,1fr));
            gap:25px;
            width:100%;
            max-width:1100px;
            justify-items:center;
            margin:40px auto 80px;
            position:relative;
            z-index:5;
        }


        /* Voucher styling */
        .voucher-container{
            width:450px;height:140px;background:rgba(11,22,44,0);
            backdrop-filter:blur(5px);border:1px solid rgba(234,234,234,0);
            border-radius:12px;display:flex;align-items:center;position:relative;
            overflow:hidden;box-shadow:0 10px 25px rgba(0,0,0,0.3);
            transition:transform .25s ease,box-shadow .25s ease;
        }
        .voucher-container:hover{
            transform:translateY(-5px);
            box-shadow:0 0 20px #FFD84E,0 0 40px rgba(255,216,78,0.4),inset 0 0 15px rgba(255,216,78,0.2);
            border-color:#FFD84E;
        }
        .voucher-container::before,.voucher-container::after{
            content:"";position:absolute;width:24px;height:24px;background:var(--ink);border-radius:50%;
            left:153px;z-index:3;
        }
        .voucher-container::before{top:-12px;}
        .voucher-container::after{bottom:-12px;}
        .voucher-left{
            background:linear-gradient(145deg,#bd3844,#da0c33);
            width:165px;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;
            z-index:2;
        }
        .voucher-left .label{font-size:14px;font-weight:700;margin-bottom:8px;color:#fff;}
        .voucher-left .code{
            background:#FFD84E;color:#212121;padding:8px 18px;border-radius:4px;
            font-weight:900;font-size:20px;letter-spacing:1px;box-shadow:0 2px 5px rgba(0,0,0,0.2);
        }
        .voucher-right{flex:1;padding:0 20px;display:flex;flex-direction:column;align-items:flex-start;position:relative;}
        .voucher-right::before{
            content:"";position:absolute;top:0;bottom:0;left:-1px;width:2px;
            background:repeating-linear-gradient(to bottom,rgba(255,255,255,0.3),rgba(255,255,255,0.3)6px,transparent 6px,transparent 12px);
            z-index:1;
        }
        .voucher-right .discount-line{display:flex;align-items:baseline;line-height:1;}
        .voucher-right .discount-text{font-size:28px;font-weight:900;color:#FFD84E;margin-right:8px;}
        .voucher-right .discount-value{font-size:72px;font-weight:900;color:#FFD84E;}
        .voucher-right .currency-wrapper{display:flex;flex-direction:column;align-items:flex-start;font-weight:700;color:#FFD84E;margin-left:5px;}
        .voucher-right .currency-top,.voucher-right .currency-bottom{font-size:22px;}
        .voucher-right .condition{font-size:15px;font-weight:500;color:#fff;margin-top:8px;}
        .voucher-status{display:none;}
    </style>
</head>


<body>
<div class="tickets-wall" aria-hidden="true">
    <div class="tickets-layer l1"></div>
    <div class="tickets-layer l2"></div>
</div>
<div class="grain"></div>


<div id="header"></div>


<h1>üéüÔ∏è ∆Øu ƒê√£i CineMaster</h1>
<div class="discount-list" id="discount-list"></div>


<div id="footer"></div>


<!-- ‚úÖ Header & Footer ƒë·ªìng b·ªô -->
<script>
    (async function loadHeaderFooter(){
        const headerEl = document.getElementById("header");
        const footerEl = document.getElementById("footer");
        try{
            const headerHtml = await (await fetch("../home/customer-header.html")).text();
            headerEl.innerHTML = headerHtml;
            headerEl.querySelectorAll("script").forEach(s=>{
                const ns=document.createElement("script");
                if(s.src) ns.src=s.src; else ns.textContent=s.textContent;
                document.body.appendChild(ns);
            });


            const footerHtml = await (await fetch("../home/footer.html")).text();
            footerEl.innerHTML = footerHtml;
        }catch(err){
            console.error("L·ªói load header/footer:",err);
        }
    })();
</script>


<script type="module">
    import { discountApi } from '../js/api/discountApi.js';


    async function loadDiscounts(){
        try{
            const data = await discountApi.getAll();
            const list = data.result || data;
            const container = document.getElementById("discount-list");


            if(!list.length){
                container.innerHTML = `<p style="color:#ccc;">Kh√¥ng c√≥ ∆∞u ƒë√£i n√†o hi·ªán t·∫°i.</p>`;
                return;
            }


            container.innerHTML = list.map(d=>{
                const isPercent = !d.fixedAmount;
                let value="0",suffixTop="",suffixBottom="ƒê·ªíNG";
                if(isPercent){
                    value = d.percentOff || 0;
                    suffixTop="%",suffixBottom="";
                }else{
                    const amount=d.fixedAmount||0;
                    if(amount>=1000){
                        value=Math.floor(amount/1000);
                        suffixTop=`.${(amount%1000).toString().padStart(3,'0')}`;
                    }else value=amount;
                }
                const status = d.discountStatus==="EXPIRED"?"H·∫æT H·∫†N":"ACTIVE";
                const statusClass = d.discountStatus==="EXPIRED"?"EXPIRED":"ACTIVE";
                return `
           <div class="voucher-container">
               <div class="voucher-left">
                   <span class="label">NH·∫¨P M√É</span>
                   <span class="code">${d.code}</span>
               </div>
               <div class="voucher-right">
                   <div class="discount-line">
                       <span class="discount-text">GI·∫¢M</span>
                       <span class="discount-value">${value}</span>
                       <div class="currency-wrapper">
                           <span class="currency-top">${suffixTop}</span>
                           <span class="currency-bottom">${suffixBottom}</span>
                       </div>
                   </div>
                   <div class="condition">${d.discountDescription || "ƒê∆°n t·ª´ 50.000ƒê"}</div>
               </div>
               <span class="voucher-status ${statusClass}">${status}</span>
           </div>`;
            }).join("");
        }catch(err){
            console.error("‚ùå L·ªói t·∫£i khuy·∫øn m√£i:",err);
            document.getElementById("discount-list").innerHTML =
                `<p style="color:red;">L·ªói t·∫£i d·ªØ li·ªáu khuy·∫øn m√£i!</p>`;
        }
    }
    loadDiscounts();
</script>
</body>
</html>


<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Xác thực email</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Chakra+Petch:wght@400;600&display=swap');

        body{
            font-family:'Chakra Petch',sans-serif;
            background:linear-gradient(45deg,#0a0a23,#1a2a44,#2c5364,#e53935);
            background-size:400% 400%;
            display:flex; justify-content:center; align-items:center;
            height:100vh; margin:0; padding:0; color:#e0e0e0; overflow:hidden; position:relative;
            animation:gradientFlow 10s ease infinite;
        }
        @keyframes gradientFlow{0%{background-position:0% 0%}50%{background-position:100% 100%}100%{background-position:0% 0%}}

        .container{
            background:rgba(10,10,35,.85); backdrop-filter:blur(10px);
            width:100%; max-width:600px; padding:40px; border-radius:20px;
            box-shadow:0 0 40px rgba(41,182,246,.6),0 0 60px rgba(231,76,60,.5);
            border:2px solid rgba(41,182,246,.9);
            display:flex; flex-direction:column; align-items:center; justify-content:center;
        }

        h2{
            font-family:'Orbitron',sans-serif; color:#e53935; font-size:2.8em; font-weight:700;
            text-transform:uppercase; letter-spacing:4px;
            text-shadow:0 0 30px rgba(231,76,60,.9),0 0 60px rgba(231,76,60,.7);
            margin-bottom:40px; animation:neonPulse 2s ease-in-out infinite;
        }
        @keyframes neonPulse{0%{opacity:.8}50%{opacity:1}100%{opacity:.8}}

        form{display:grid; grid-template-columns:1fr; gap:25px; width:100%; max-width:400px; perspective:1000px;}
        .input-group{position:relative; transform:perspective(1000px) translateZ(10px); transition:transform .3s ease, box-shadow .3s ease;}
        .input-group:hover{transform:perspective(1000px) translateZ(20px); box-shadow:0 0 30px rgba(41,182,246,.8);}
        .input-group label{
            position:absolute; top:50%; left:15px; transform:translateY(-50%);
            font-family:'Chakra Petch',sans-serif; font-weight:600; font-size:.9em; color:#b0bec5; letter-spacing:1.5px; transition:all .3s ease; pointer-events:none;
        }
        .input-group input:focus + label,
        .input-group input:not(:placeholder-shown) + label{top:5px; font-size:.7em; color:#29b6f6; text-shadow:0 0 15px rgba(41,182,246,.9);}
        .input-group input{
            width:100%; padding:12px 15px; border-radius:25px; border:2px solid rgba(41,182,246,.9);
            background:rgba(15,15,40,.9); color:#e0e0e0; font-family:'Chakra Petch',sans-serif; font-size:1em;
            transition:all .3s ease; box-shadow:0 0 20px rgba(41,182,246,.5);
        }
        .input-group input:focus{border-color:#e53935; box-shadow:0 0 25px rgba(231,76,60,.9); outline:none;}

        button{
            width:100%; max-width:250px; padding:12px; border:none; border-radius:25px;
            background:linear-gradient(90deg,#e53935,#b71c1c); color:#fff;
            font-family:'Orbitron',sans-serif; font-size:1.2em; font-weight:700; cursor:pointer;
            transition:all .3s ease; text-transform:uppercase; letter-spacing:2px; box-shadow:0 0 30px rgba(231,76,60,.8);
            margin:25px auto 0;
        }
        button:hover{background:linear-gradient(90deg,#b71c1c,#8b1212); transform:scale(1.05); box-shadow:0 0 40px rgba(231,76,60,1);}
        button:active{transform:scale(.95);}

        #result{
            text-align:center; padding:10px; margin-top:15px; font-family:'Chakra Petch',sans-serif; font-weight:600; font-size:.9em; color:#e0e0e0;
            background:rgba(15,15,40,.9); box-shadow:0 0 20px rgba(41,182,246,.6); border-radius:10px; animation:fadeIn .5s ease-in;
        }
        @keyframes fadeIn{from{opacity:0}to{opacity:1}}

        .link{text-align:center; margin-top:20px;}
        .link a{
            font-family:'Chakra Petch',sans-serif; color:#29b6f6; text-decoration:none; font-weight:600; font-size:.95em; letter-spacing:1.5px;
            transition:all .3s ease; text-shadow:0 0 15px rgba(41,182,246,.9);
        }
        .link a:hover{color:#4fc3f7; text-shadow:0 0 25px rgba(41,182,246,1);}
    </style>
</head>
<body>
<div class="container">
    <h2>CinemaPulse</h2>
    <form id="verifyForm">
        <div class="input-group">
            <input type="email" id="verEmail" placeholder=" " readonly />
            <label for="verEmail">Email</label>
        </div>
        <div class="input-group">
            <input type="text" id="verCode" placeholder=" " required />
            <label for="verCode">Mã xác thực</label>
        </div>
        <button type="submit">Xác thực</button>
        <div id="result"></div>
    </form>
    <div class="link">
        <a href="register.html">Quay lại đăng ký</a>
    </div>
</div>

<script>
    // Trỏ đúng group /auth, KHÔNG lặp /verify lần 2
    const API_BASE = "http://localhost:8080/demo/api/auth";

    function getEmailFromQuery() {
        const params = new URLSearchParams(window.location.search);
        const email = params.get('email') || '';
        document.getElementById("verEmail").value = decodeURIComponent(email);
    }

    async function handleVerify(e) {
        e.preventDefault();
        const email = document.getElementById("verEmail").value.trim();
        const code = document.getElementById("verCode").value.trim();
        const resultBox = document.getElementById("result");

        try {
            // Nếu backend là GET (phổ biến cho verify OTP):
            const res = await fetch(`${API_BASE}/verify?email=${encodeURIComponent(email)}&code=${encodeURIComponent(code)}`);
            const text = await res.text();

            resultBox.innerText = text;
            resultBox.style.color = res.ok ? "#29b6f6" : "#e53935";

            // Tuỳ ý: chuyển sang login nếu verify thành công
            // if (res.ok) window.location.href = "login.html";
        } catch (err) {
            resultBox.innerText = "Lỗi: " + err.message;
            resultBox.style.color = "#e53935";
        }
    }

    document.getElementById("verifyForm").addEventListener("submit", handleVerify);
    window.onload = getEmailFromQuery;
</script>
</body>
</html>
